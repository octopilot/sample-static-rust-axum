name: Release

on:
  workflow_dispatch:
    inputs:
      bump:
        description: "Version bump type"
        required: true
        default: "patch"
        type: choice
        options:
          - patch
          - minor
          - major

jobs:
  release:
    uses: octopilot/octopilot-workflows/.github/workflows/workflow-release.yml@main
    with:
      mode: rust
      bump: ${{ inputs.bump }}
      # Cargo.toml lives under api/ in this repo
      file: api/Cargo.toml
    secrets:
      # REPO_PAT is a Personal Access Token with `contents:write` configured
      # at the octopilot org level. It is required because GITHUB_TOKEN cannot
      # push commits back to the repo in a way that triggers downstream CI.
      repo_token: ${{ secrets.REPO_PAT }}
